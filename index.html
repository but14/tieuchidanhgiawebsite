<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Công cụ So sánh Nhà cung cấp Website Resort/Khách sạn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      th,
      td {
        border: 1px solid #e2e8f0;
        padding: 10px;
        vertical-align: top;
        text-align: left;
        min-width: 150px;
      }
      th:first-child,
      td:first-child {
        min-width: 280px;
        font-weight: 500;
      }
      th {
        background-color: #f8fafc;
        font-weight: 600;
      }
      td {
        background-color: #ffffff;
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      .tab-btn {
        background-color: transparent;
        border: 0;
        border-bottom: 2px solid transparent;
        cursor: pointer;
        padding: 0.75rem 0.5rem;
        margin-bottom: -1px;
        font-size: 0.875rem;
        font-weight: 400;
        color: #4b5563;
        transition: all 150ms;
      }
      .tab-btn:hover {
        color: #059669; /* emerald-600 */
      }
      .tab-btn.active {
        border-color: #059669; /* emerald-600 */
        color: #047857; /* emerald-700 */
        font-weight: 500;
      }
      td[contenteditable="true"] {
        background-color: #fefce8;
      }
      td[contenteditable="true"]:focus {
        outline: 2px solid #059669;
        background-color: #ffffff;
      }
      .chart-container {
        border: 1px solid #e2e8f0;
        padding: 1rem;
        border-radius: 0.75rem;
        background-color: #fff;
      }
      .evaluation-basis {
        font-size: 0.8rem;
        color: #475569;
        background-color: #f1f5f9 !important;
        padding: 6px 10px;
      }
      .group-score-display {
        font-weight: bold;
      }
      .group-score-display .max-score {
        color: #64748b;
        font-weight: normal;
      }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-800 p-4 sm:p-6 md:p-8">
    <div class="max-w-7xl mx-auto bg-white rounded-xl shadow-lg p-6">
      <div
        class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6"
      >
        <div>
          <h1 class="text-2xl font-bold text-gray-900">
            Công cụ So sánh Nhà cung cấp Website Resort
          </h1>
          <p class="mt-1 text-gray-500">
            Đánh giá toàn diện về năng lực, công nghệ, chi phí và hậu mãi.
          </p>
        </div>
        <button
          id="export-btn"
          class="mt-4 sm:mt-0 w-full sm:w-auto bg-emerald-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-emerald-700 transition duration-300 flex items-center justify-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 mr-2"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              d="M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 10-1.09-1.03l-2.905 3.079V2.75z"
            />
            <path
              d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"
            />
          </svg>
          Xuất ra Excel
        </button>
      </div>

      <div class="border-b border-gray-200 mb-6 overflow-x-auto">
        <nav class="flex -mb-px" aria-label="Tabs">
          <button class="tab-btn active whitespace-nowrap" data-tab="tab1">
            1. Thông tin chung
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab1-5">
            2. Quản lý & Đội ngũ
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab2">
            3. Bảng Chấm Điểm
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab3">
            4. Công nghệ & Kỹ thuật
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab4">
            5. Giao diện & Tính năng
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab5">
            6. Chi phí
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab6">
            7. Bàn giao & Hỗ trợ
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab7">
            8. Dashboard
          </button>
          <button class="tab-btn whitespace-nowrap" data-tab="tab8">
            9. Đánh giá SWOT
          </button>
        </nav>
      </div>

      <div id="tab-container" class="overflow-x-auto">
        <div id="tab1" class="tab-content active">
          <h3 class="font-semibold mb-2">1. Thông tin chung về Nhà cung cấp</h3>
          <table id="table-1" class="w-full text-sm"></table>
        </div>
        <div id="tab1-5" class="tab-content">
          <h3 class="font-semibold mb-2">
            2. Phân tích Quản lý dự án & Đội ngũ
          </h3>
          <table id="table-1-5" class="w-full text-sm"></table>
        </div>
        <div id="tab2" class="tab-content">
          <h3 class="font-semibold mb-2">3. Bảng Chấm Điểm Tổng Hợp</h3>
          <p class="text-sm text-gray-500 mb-4">
            Chấm điểm cho từng tiêu chí con (thang 0-10). Điểm nhóm và Tổng điểm
            sẽ được tự động tính toán.
          </p>
          <table id="table-2" class="w-full text-sm"></table>
        </div>
        <div id="tab3" class="tab-content">
          <h3 class="font-semibold mb-2">4. Phân tích Công nghệ & Kỹ thuật</h3>
          <table id="table-3" class="w-full text-sm"></table>
        </div>
        <div id="tab4" class="tab-content">
          <h3 class="font-semibold mb-2">5. Phân tích Giao diện & Tính năng</h3>
          <table id="table-4" class="w-full text-sm"></table>
        </div>
        <div id="tab5" class="tab-content">
          <h3 class="font-semibold mb-2">6. Phân tích Chi phí</h3>
          <table id="table-5" class="w-full text-sm"></table>
        </div>
        <div id="tab6" class="tab-content">
          <h3 class="font-semibold mb-2">7. Thông tin về Bàn giao & Hậu mãi</h3>
          <table id="table-6" class="w-full text-sm"></table>
        </div>

        <div id="tab7" class="tab-content">
          <div class="flex justify-between items-center mb-4">
            <h3 class="font-semibold text-xl">
              8. Dashboard - Bảng điều khiển Trực quan
            </h3>
            <button
              id="update-charts-btn"
              class="bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700 transition duration-300 flex items-center"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 mr-2"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M15.312 11.424a5.5 5.5 0 01-9.201-4.46_5.5 5.5 0 011.643-1.644l.11-.112a.75.75 0 011.06 1.06l-.11.112a4 4 0 00-1.196 1.196 4.002 4.002 0 006.585 3.235l.233.233A5.5 5.5 0 0115.312 11.424zM18.75 13a.75.75 0 01-.75.75h-3.5a.75.75 0 010-1.5h2.323l-3.3-3.3a.75.75 0 111.06-1.06l3.3 3.3V8.5a.75.75 0 011.5 0v3.75c0 .414-.336.75-.75.75z"
                  clip-rule="evenodd"
                />
              </svg>
              Cập nhật Biểu đồ & Bảng
            </button>
          </div>
          <div class="space-y-8">
            <div class="chart-container">
              <h4 class="font-bold text-center mb-4">Bảng xếp hạng tổng thể</h4>
              <table id="table-7-summary" class="w-full text-sm"></table>
            </div>
            <div class="chart-container">
              <h4 class="font-bold text-center mb-2">
                So sánh Giá trị: Năng lực vs. Chi phí
              </h4>
              <canvas id="valueChart"></canvas>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div class="chart-container">
                <h4 class="font-bold text-center mb-2">
                  So sánh Năng lực & Kinh nghiệm
                </h4>
                <canvas id="competencyChart"></canvas>
              </div>
              <div class="chart-container">
                <h4 class="font-bold text-center mb-2">
                  So sánh Giải pháp Kỹ thuật
                </h4>
                <canvas id="techChart"></canvas>
              </div>
              <div class="chart-container">
                <h4 class="font-bold text-center mb-2">
                  So sánh Thiết kế & Tính năng
                </h4>
                <canvas id="featureChart"></canvas>
              </div>
              <div class="chart-container">
                <h4 class="font-bold text-center mb-2">
                  So sánh Quản lý dự án & Quy trình
                </h4>
                <canvas id="processChart"></canvas>
              </div>
              <div class="chart-container">
                <h4 class="font-bold text-center mb-2">
                  So sánh Hậu mãi & Hỗ trợ
                </h4>
                <canvas id="supportChart"></canvas>
              </div>
            </div>
          </div>
        </div>
        <div id="tab8" class="tab-content">
          <h3 class="font-semibold mb-2">9. Phân tích SWOT</h3>
          <table id="table-8-swot" class="w-full text-sm"></table>
        </div>
      </div>
    </div>

    <script>
      const sampleData = {
        vendors: ["Haco Agency", "OI Agency", "Sao Kim", "Adina Agency"],
        "table-1": [
          ["Hạng mục", "Haco Agency", "OI Agency", "Sao Kim", "Adina Agency"],
          [
            "Người liên hệ",
            "Phạm Nguyễn Hoàng Long",
            "Phạm Nguyễn Hoàng Long",
            "Phạm Nguyễn Hoàng Long",
            "Phạm Nguyễn Hoàng Long",
          ],
          ["Số năm kinh nghiệm", "10 năm", "5 năm", "15 năm", "13 năm"],
          [
            "Quy mô công ty (số nhân sự)",
            "40-50 nhân sự",
            "40-50 nhân sự",
            "50 - 150 nhân sự",
            "40-50 nhân sự",
          ],
          [
            "Dự án có quy mô cao nhất đã thực hiện",
            "Cen Group, Viettel",
            "The Anam, Six Senses",
            "Woori Bank, Ascott",
            "Phương Nam Resort",
          ],
          [
            "Các yếu tố quan trọng dẫn đến thành công dự án (theo NCC)",
            "Giao tiếp chặt chẽ, hiểu rõ mục tiêu, đội ngũ kinh nghiệm",
            "Thấu hiểu insight khách hàng, quy trình tinh gọn, công nghệ hiện đại",
            "Nghiên cứu sâu, thiết kế sáng tạo, thực thi chuyên nghiệp",
            "",
          ],
        ],
        "table-1-5": [
          [
            "Hạng mục Quản lý Dự án & Đội ngũ",
            "Haco Agency",
            "OI Agency",
            "Sao Kim",
            "Adina Agency",
          ],
          [
            "Số lượng & Trình độ nhân sự tham gia dự án",
            "3 nhân sự",
            "4 nhân sự",
            "8 nhân sự",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Chứng chỉ/Kinh nghiệm nổi bật của đội ngũ",
            "PMI-ACP cho Project Manager",
            "Đội ngũ có chứng chỉ Google, Meta",
            "Nhiều năm kinh nghiệm với các đối tác lớn, đội ngũ designer mạnh",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Mô hình triển khai (Agile, Scrum, Waterfall...)",
            "Agile/Scrum",
            "Agile/Scrum",
            "Agile/Scrum",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Công cụ quản lý dự án (Jira, MS Project...)",
            "Jira, Slack, Google Workspace",
            "Notion, Slack",
            "Base.vn, Jira",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Quy trình quản lý thay đổi & xử lý mâu thuẫn",
            "Chưa rõ, cần làm rõ khi họp",
            "Quy trình Change Request (CR) rõ ràng, báo giá chi tiết cho các thay đổi",
            "Linh hoạt, có quy trình quản lý thay đổi và xử lý khủng hoảng",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Nền tảng AI sử dụng trong dự án (nếu có)",
            "Chưa có",
            "Sử dụng AI trong tối ưu hình ảnh và tối ưu trải nghiệm người dùng",
            "Sử dụng AI trong tối ưu hình ảnh và tối ưu trải nghiệm người dùng",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
        ],
        "table-2-scores": {
          "Haco Agency": {
            A1: 5,
            A2: 8,
            A3: 7,
            B1: 6,
            B2: 5,
            B3: 6,
            B4: 2,
            B5: 5,
            C1: 9,
            C2: 5,
            C3: 2,
            C4: 4,
            F1: 8,
            F2: 5,
            F3: 4,
            D1: 3,
            D2: 3,
            E1: 8,
            E2: 8,
            E3: 5,
          },
          "OI Agency": {
            A1: 7,
            A2: 8,
            A3: 8,
            B1: 8,
            B2: 8,
            B3: 8,
            B4: 8,
            B5: 8,
            C1: 9,
            C2: 9,
            C3: 9,
            C4: 9,
            F1: 8,
            F2: 8,
            F3: 8,
            D1: 9,
            D2: 8,
            E1: 10,
            E2: 9,
            E3: 9,
          },
          "Sao Kim": {
            A1: 9,
            A2: 9,
            A3: 9,
            B1: 8,
            B2: 8,
            B3: 8,
            B4: 9,
            B5: 8,
            C1: 9,
            C2: 9,
            C3: 9,
            C4: 8,
            F1: 8,
            F2: 8,
            F3: 8,
            D1: 7,
            D2: 9,
            E1: 8,
            E2: 9,
            E3: 7,
          },
          "Adina Agency": {
            A1: 8,
            A2: 8,
            A3: 2,
            B1: 6,
            B2: 6,
            B3: 2,
            B4: 2,
            B5: 2,
            C1: 2,
            C2: 2,
            C3: 1,
            C4: 2,
            F1: 2,
            F2: 2,
            F3: 2,
            D1: 1,
            D2: 1,
            E1: 1,
            E2: 1,
            E3: 1,
          },
        },
        "table-3": [
          [
            "Hạng mục Kỹ thuật",
            "Haco Agency",
            "OI Agency",
            "Sao Kim",
            "Adina Agency",
          ],
          [
            "Nền tảng Frontend (React, Vue, Next.js...)",
            "Wordpress (Flatsome Theme)",
            "Wordpress",
            "Wordpress",
            "Wordpress",
          ],
          [
            "Nền tảng Backend & CMS",
            "Wordpress (PHP, MySQL)",
            "Wordpress (PHP, MySQL)",
            "Wordpress (PHP, MySQL)",
            "Wordpress (PHP, MySQL)",
          ],
          [
            "Nếu là WordPress: Framework sử dụng (Genesis, Underscores...)",
            "Sử dụng Theme Flatsome 3.19.5",
            "Sử dụng Theme Hello, Elementor, code tùy chỉnh",
            "Elementor, code tùy chỉnh",
            "Flatsome, code tùy chỉnh",
          ],
          [
            "Nếu là WordPress: Số lượng & tên plugin có phí / miễn phí",
            "Có plugin miễn phí, bản quyền, và code thêm (Rank Math, Yoast SEO, WP Rocket)",
            "Có plugin miễn phí, bản quyền, và code thêm (Woocommerce, Elementor Pro, Rank Math Pro)",
            "Ưu tiên sử dụng plugin miễn phí, dùng plugin bản quyền theo yêu cầu của chủ đầu tư, và code thêm",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Nếu là WordPress: Quy trình quản lý xung đột plugin",
            "Review mã nguồn định kỳ",
            "Kiểm tra trên môi trường Staging, review mã nguồn trước khi triển khai",
            "Kiểm soát mã nguồn và lập trình, chạy thử trên các trình duyệt",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Kiến trúc Hạ tầng (Cloud, VPS, Server riêng...)",
            "Sử dụng Cloud VPS, có thể mở rộng",
            "Sử dụng Cloud VPS, có thể mở rộng",
            "Sử dụng Cloud VPS, có thể mở rộng",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Cam kết Core Web Vitals (LCP, INP, CLS)",
            "LCP < 2.5s, INP < 200ms, CLS < 0.1",
            "Cam kết pass các chỉ số Core Web Vitals (Good)",
            "Cam kết tối ưu tốc độ và Core Web Vitals",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Phương pháp đánh giá bảo mật (Pentest, Scan, ISO...)",
            "Không có",
            "Theo chuẩn ISO 27001",
            "Tích hợp SSL, thay đổi prefix, Malware Scan, thay đổi salts & keys, thay đổi đường dẫn đăng nhập, chặn IP (Wordfence)",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Khả năng mở rộng & Chất lượng Code",
            "Thấp, chưa tuân thủ theo các tiêu chuẩn",
            "Cao, code sạch, có tài liệu, dễ dàng nâng cấp",
            "Rất tốt, dễ bảo trì, tuân thủ các chuẩn quốc tế",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
        ],
        "table-4": [
          [
            "Hạng mục Tính năng",
            "Haco Agency",
            "OI Agency",
            "Sao Kim",
            "Adina Agency",
          ],
          [
            "Quy trình thiết kế UI/UX (Wireframe, Prototype...)",
            "Wireframe > Mockup > Prototype (Figma)",
            "Wireframe > Mockup > Prototype (Figma)",
            "Wireframe > Mockup > Prototype (Figma)",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Cam kết/Chứng nhận về tính độc quyền của giao diện",
            "Chưa có cam kết rõ ràng",
            "Cam kết giao diện độc quyền",
            "Cam kết giao diện độc quyền",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Công cụ thiết kế hình ảnh & Tình trạng bản quyền",
            "Thiết kế bằng Figma. Hình ảnh sử dụng từ nguồn như Freepik, Unsplash",
            "Thiết kế bằng Figma, Adobe. Hình ảnh sử dụng từ nhiều nguồn uy tín độc quyền cao Adobe Stock, Shutterstock",
            "Thiết kế bằng Figma. Hình ảnh sử dụng từ nguồn như Freepik, Unsplash, có mua ảnh bản quyền khi cần",
            "Thiết kế bằng Figma, Adobe",
          ],
          [
            "Module Đặt phòng (Tích hợp API / Xây dựng riêng)",
            "Chưa có kinh nghiệm thực hiện chức năng booking",
            "Sẵn sàng tích hợp API của PMS, có thể xây dựng module booking riêng",
            "Sẵn sàng tích hợp API của PMS, có thể xây dựng module booking riêng",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Tích hợp Channel Manager (Nếu có)",
            "Có, tích hợp qua API của PMS",
            "Có, tích hợp qua API của PMS",
            "Có, tích hợp qua API của PMS",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Cổng thanh toán tích hợp (Nội địa & Quốc tế)",
            "Chưa rõ ràng về vấn đề thực hiện này",
            "Tích hợp cổng thanh toán nội địa (VNPay) và quốc tế (Stripe, Paypal)",
            "Tích hợp cổng thanh toán nội địa (VNPay) và quốc tế (Stripe, Paypal)",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Nền tảng kỹ thuật SEO (Schema, Sitemap...)",
            "Nền tảng cơ bản, sử dụng Yoast SEO",
            "Tối ưu SEO on-page toàn diện, cấu trúc schema, Rank Math Pro",
            "Cấu trúc chuẩn SEO, hỗ trợ các plugin SEO phổ biến, tư vấn chiến lược",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
        ],
        "table-5": [
          [
            "Khoản mục chi phí",
            "Haco Agency",
            "OI Agency",
            "Sao Kim",
            "Adina Agency",
          ],
          [
            "Chi phí Thiết kế & Lập trình (trọn gói)",
            "Cần yêu cầu báo giá chi tiết",
            "60,000,000đ (trọn gói)",
            "80,000,000đ (trọn gói)",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Chi phí bản quyền (Plugin, Theme, AI Tools...)",
            "Cần yêu cầu báo giá chi tiết",
            "Đã bao gồm trong chi phí thiết kế",
            "Đã bao gồm trong chi phí thiết kế",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Chi phí duy trì (từ năm thứ 2)",
            "Nhà cung cấp chưa bổ sung thông tin này",
            "Nhà cung cấp chưa bổ sung thông tin này",
            "5,000,000đ/năm (bao gồm hosting, domain, bảo trì)",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Các chi phí ẩn/phát sinh (nếu có)",
            "Không có, các yêu cầu ngoài phạm vi sẽ được báo giá riêng",
            "Cam kết không chi phí ẩn, mọi phát sinh được báo giá trước",
            "Dịch vụ mua domain, hosting, bảo trì sẽ tính phí riêng (theo năm)",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
        ],
        "table-6": [
          [
            "Hạng mục Hậu mãi",
            "Haco Agency",
            "OI Agency",
            "Sao Kim",
            "Adina Agency",
          ],
          [
            "Bàn giao Source Code & Tài liệu kỹ thuật",
            "Có, bàn giao toàn bộ source code và tài khoản quản trị",
            "Bàn giao đầy đủ source code, tài liệu và video hướng dẫn",
            "Toàn bộ source code, tài khoản quản trị. File thiết kế đầy đủ các định dạng Adobe XD, Figma",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Công tác bàn giao & hướng dẫn sử dụng bộ thương hiệu",
            "Tổ chức buổi training online, cung cấp video và tài liệu hướng dẫn chi tiết",
            "Training online 1-1, tài liệu hướng dẫn chi tiết",
            "Link hướng dẫn sử dụng Website. Đào tạo online 2 tiếng sử dụng Website",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Thời gian bảo hành (số tháng)",
            "12 tháng",
            "24 tháng",
            "12 tháng",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Phạm vi bảo hành (Lỗi kỹ thuật, hiệu năng...)",
            "Lỗi kỹ thuật phát sinh từ code của NCC, không bao gồm lỗi do người dùng hoặc bên thứ ba",
            "Bảo hành toàn bộ lỗi kỹ thuật & hiệu năng, hỗ trợ tư vấn sử dụng",
            "Bảo hành lỗi kỹ thuật của hệ thống",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Chính sách sao lưu (Backup) dữ liệu",
            "Chưa đề cập, cần làm rõ",
            "Backup tự động hàng ngày, lưu trữ 14 ngày",
            "Backup định kỳ theo tuần",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
          [
            "Kênh & Thời gian hỗ trợ kỹ thuật (Email, Zalo, 24/7...)",
            "Email, Zalo, ticket system (Giờ hành chính)",
            "Hệ thống ticket, Zalo, Email. Hỗ trợ 24/7 cho các lỗi nghiêm trọng",
            "Email, Hotline (giờ hành chính)",
            "Nhà cung cấp chưa bổ sung thông tin này",
          ],
        ],
        "table-8-swot": [
          ["Phân tích", "Haco Agency", "OI Agency", "Sao Kim", "Adina Agency"],
          [
            "Strengths (Điểm mạnh)",
            "Quy trình thiết kế UI/UX tốt trên Figma. Có kinh nghiệm quản lý dự án theo mô hình Agile/Scrum.",
            "Năng lực toàn diện, cân bằng. Chính sách hậu mãi vượt trội (bảo hành 24 tháng, hỗ trợ 24/7). Chi phí hợp lý và minh bạch. Quy trình làm việc và kỹ thuật rõ ràng.",
            "Kinh nghiệm lâu năm nhất (15 năm) và portfolio với các khách hàng lớn. Năng lực kỹ thuật và bảo mật rất mạnh, quy trình chi tiết. Đội ngũ dự án đông đảo.",
            "Số năm kinh nghiệm trên thị trường khá tốt (13 năm). Đã thực hiện dự án trong ngành (Phương Nam Resort).",
          ],
          [
            "Weaknesses (Điểm yếu)",
            "Yếu về kỹ thuật: không có kinh nghiệm booking, không có quy trình bảo mật, chất lượng code thấp. Chi phí duy trì không rõ ràng và có thể cao. Nhiều thông tin quan trọng về hậu mãi chưa được làm rõ.",
            "Số năm kinh nghiệm ít hơn so với Sao Kim và Adina, có thể là một điểm cân nhắc đối với các dự án đòi hỏi kinh nghiệm thị trường sâu rộng.",
            "Chi phí triển khai cao nhất trong các nhà cung cấp. Chính sách hậu mãi (bảo hành 12 tháng, hỗ trợ giờ hành chính) kém cạnh tranh hơn so với OI.",
            "Gần như toàn bộ thông tin về quy trình, kỹ thuật, tính năng, chi phí và hậu mãi đều không được cung cấp. Thể hiện sự thiếu chuyên nghiệp trong quá trình tư vấn và trình bày giải pháp.",
          ],
          [
            "Opportunities (Cơ hội)",
            "Có thể tập trung vào các dự án không yêu cầu kỹ thuật phức tạp, chỉ tập trung vào thiết kế giao diện và giới thiệu.",
            "Có thể trở thành lựa chọn hàng đầu cho các dự án yêu cầu chất lượng cao với ngân sách hợp lý, đặc biệt với chính sách bảo hành an toàn.",
            "Phù hợp với các tập đoàn lớn, yêu cầu cao về kinh nghiệm, quy mô và sự an toàn, ít nhạy cảm về giá.",
            "Cần cải thiện toàn diện về quy trình làm việc và cung cấp thông tin cho khách hàng để có thể tận dụng kinh nghiệm sẵn có.",
          ],
          [
            "Threats (Thách thức)",
            "Dễ dàng bị loại bỏ bởi các đối thủ cung cấp giải pháp toàn diện như OI và Sao Kim. Rủi ro về mặt kỹ thuật và bảo mật cho khách hàng.",
            "Cần phải liên tục chứng minh năng lực để cạnh tranh với các agency có lịch sử lâu đời hơn như Sao Kim.",
            "Có thể mất khách hàng vào tay các đối thủ linh hoạt và có chi phí tốt hơn như OI, đặc biệt là các dự án của SME.",
            "Sẽ bị loại ngay từ vòng đầu trong các cuộc đấu thầu cạnh tranh do thiếu thông tin và sự thiếu chuyên nghiệp.",
          ],
        ],
      };

      document.addEventListener("DOMContentLoaded", function () {
        function createScoringTable() {
          const table = document.getElementById("table-2");
          const vendors = sampleData.vendors;
          const scores = sampleData["table-2-scores"];

          const structure = [
            {
              key: "A",
              title: "A. NĂNG LỰC & KINH NGHIỆM",
              weight: 15,
              children: [
                {
                  key: "A1",
                  title: "1. Kinh nghiệm & Các dự án tương tự",
                  weight: 5,
                },
                {
                  key: "A2",
                  title: "2. Năng lực tài chính & sự ổn định của NCC",
                  weight: 5,
                  basis: "Doanh thu (Tab 1)",
                },
                {
                  key: "A3",
                  title: "3. Năng lực đội ngũ (Trình độ, chứng chỉ)",
                  weight: 5,
                  basis: "Trình độ nhân sự (Tab 2)",
                },
              ],
            },
            {
              key: "B",
              title: "B. GIẢI PHÁP KỸ THUẬT",
              weight: 25,
              children: [
                {
                  key: "B1",
                  title: "1. Nền tảng công nghệ (FE, BE, CMS)",
                  weight: 6,
                  basis: "Nền tảng Backend (Tab 4)",
                },
                {
                  key: "B2",
                  title: "2. Chuyên sâu về WordPress (Nếu có)",
                  weight: 4,
                  basis: "Framework WordPress (Tab 4)",
                },
                {
                  key: "B3",
                  title: "3. Tối ưu hiệu năng & Core Web Vitals",
                  weight: 5,
                  basis: "Core Web Vitals (Tab 4)",
                },
                {
                  key: "B4",
                  title: "4. Quy trình & Phương pháp đảm bảo bảo mật",
                  weight: 5,
                  basis: "Đánh giá bảo mật (Tab 4)",
                },
                {
                  key: "B5",
                  title: "5. Kiến trúc hạ tầng & Khả năng mở rộng",
                  weight: 5,
                },
              ],
            },
            {
              key: "C",
              title: "C. THIẾT KẾ & TÍNH NĂNG",
              weight: 20,
              children: [
                {
                  key: "C1",
                  title: "1. Quy trình & Chất lượng thiết kế UI/UX",
                  weight: 6,
                  basis: "Quy trình thiết kế (Tab 5)",
                },
                {
                  key: "C2",
                  title: "2. Đảm bảo bản quyền & tính độc quyền",
                  weight: 5,
                  basis: "Chứng nhận độc quyền (Tab 5)",
                },
                {
                  key: "C3",
                  title: "3. Hệ thống Đặt phòng & Thanh toán",
                  weight: 5,
                  basis: "Module Đặt phòng (Tab 5)",
                },
                { key: "C4", title: "4. Nền tảng kỹ thuật cho SEO", weight: 4 },
              ],
            },
            {
              key: "F",
              title: "F. QUẢN LÝ DỰ ÁN & QUY TRÌNH",
              weight: 15,
              children: [
                {
                  key: "F1",
                  title: "1. Mô hình & Công cụ quản lý dự án",
                  weight: 5,
                  basis: "Mô hình triển khai (Tab 2)",
                },
                {
                  key: "F2",
                  title: "2. Quy trình quản lý thay đổi & rủi ro",
                  weight: 5,
                  basis: "Quản lý thay đổi (Tab 2)",
                },
                {
                  key: "F3",
                  title: "3. Việc áp dụng AI & công cụ hiện đại",
                  weight: 5,
                  basis: "Nền tảng AI (Tab 2)",
                },
              ],
            },
            {
              key: "D",
              title: "D. CHI PHÍ",
              weight: 10,
              children: [
                {
                  key: "D1",
                  title: "1. Chi phí triển khai ban đầu & bản quyền",
                  weight: 6,
                  basis: "Chi phí Thiết kế (Tab 6)",
                },
                {
                  key: "D2",
                  title: "2. Chi phí duy trì & chi phí ẩn",
                  weight: 4,
                  basis: "Chi phí duy trì (Tab 6)",
                },
              ],
            },
            {
              key: "E",
              title: "E. HẬU MÃI & BÀN GIAO",
              weight: 15,
              children: [
                {
                  key: "E1",
                  title: "1. Thời gian & Phạm vi bảo hành",
                  weight: 5,
                  basis: "Thời gian bảo hành (Tab 7)",
                },
                {
                  key: "E2",
                  title: "2. Chất lượng bàn giao (Code, Tài liệu, Thương hiệu)",
                  weight: 5,
                  basis: "Bàn giao thương hiệu (Tab 7)",
                },
                {
                  key: "E3",
                  title: "3. Hỗ trợ kỹ thuật & Chính sách Backup",
                  weight: 5,
                  basis: "Chính sách sao lưu (Tab 7)",
                },
              ],
            },
          ];

          let headHTML = `<thead><tr><th>Tiêu chí đánh giá</th><th>Trọng số</th>`;
          vendors.forEach(
            (v) => (headHTML += `<th contenteditable="true">${v}</th>`)
          );
          headHTML += `</tr></thead>`;

          let bodyHTML = `<tbody>`;
          structure.forEach((group) => {
            bodyHTML += `<tr class="bg-emerald-100 text-emerald-900 font-bold text-base border-t-2 border-gray-300">
                        <td>${group.title}</td>
                        <td data-weight-group="${group.key}">${
              group.weight
            }</td>
                        ${vendors
                          .map(
                            (v, i) =>
                              `<td class="group-score-display bg-emerald-200" data-score-group="${group.key}" data-vendor-index="${i}"><span class="score">0.0</span> <span class="max-score">/ ${group.weight}</span></td>`
                          )
                          .join("")}
                    </tr>`;
            group.children.forEach((item) => {
              bodyHTML += `<tr>
                            <td class="pl-8">${item.title}</td>
                            <td data-weight="${item.key}">${item.weight}</td>
                            ${vendors
                              .map(
                                (v, i) =>
                                  `<td data-score="${
                                    item.key
                                  }" data-vendor-index="${i}" contenteditable="true">${
                                    scores[v]?.[item.key] || ""
                                  }</td>`
                              )
                              .join("")}
                        </tr>`;
              if (item.basis) {
                bodyHTML += `<tr><td colspan="${
                  vendors.length + 2
                }" class="evaluation-basis" data-basis-for="${
                  item.key
                }"><strong>Cơ sở:</strong></td></tr>`;
              }
            });
          });
          bodyHTML += `<tr class="font-bold bg-emerald-700 text-white text-lg">
                    <td>TỔNG CỘNG (Thang 100)</td>
                    <td id="total-weight">100</td>
                    ${vendors
                      .map((v, i) => `<td id="total-score-${i}">0.0</td>`)
                      .join("")}
                </tr>`;
          bodyHTML += `</tbody>`;

          table.innerHTML = headHTML + bodyHTML;
        }

        function populateSimpleTable(tableId, data) {
          const table = document.getElementById(tableId);
          if (!table || !data) return;
          let html = `<thead><tr>${data[0]
            .map((h, i) =>
              i === 0 ? `<th>${h}</th>` : `<th contenteditable="true">${h}</th>`
            )
            .join("")}</tr></thead><tbody>`;
          data.slice(1).forEach((row) => {
            html += `<tr>${row
              .map((cell, index) => {
                const cellContent = cell.toString().replace(/\n/g, "<br>");
                const isEditable = index !== 0;
                return `<td ${
                  isEditable ? 'contenteditable="true"' : ""
                }>${cellContent}</td>`;
              })
              .join("")}</tr>`;
          });
          html += "</tbody>";
          table.innerHTML = html;
        }

        function loadAllData() {
          populateSimpleTable("table-1", sampleData["table-1"]);
          populateSimpleTable("table-1-5", sampleData["table-1-5"]);
          createScoringTable();
          populateSimpleTable("table-3", sampleData["table-3"]);
          populateSimpleTable("table-4", sampleData["table-4"]);
          populateSimpleTable("table-5", sampleData["table-5"]);
          populateSimpleTable("table-6", sampleData["table-6"]);
          populateSimpleTable("table-8-swot", sampleData["table-8-swot"]);
        }

        const tabs = document.querySelectorAll(".tab-btn");
        tabs.forEach((tab) => {
          tab.addEventListener("click", (e) => {
            document
              .querySelectorAll(".tab-btn.active")
              .forEach((t) => t.classList.remove("active"));
            e.target.classList.add("active");
            document
              .querySelector(".tab-content.active")
              .classList.remove("active");
            document
              .getElementById(e.target.dataset.tab)
              .classList.add("active");
          });
        });

        function getCellValue(selector) {
          const element = document.querySelector(selector);
          return element
            ? parseFloat(element.innerText.replace(/[^0-9.-]+/g, "")) || 0
            : 0;
        }

        function calculateScores() {
          const vendors = Array.from(
            document.querySelectorAll("#table-2 thead th[contenteditable]")
          ).map((th) => th.innerText);
          const numVendors = vendors.length;
          const groups = ["A", "B", "C", "D", "E", "F"];
          let groupScores = Array(numVendors)
            .fill(null)
            .map(() => ({}));
          let totalScores = Array(numVendors).fill(0);

          vendors.forEach((_, vendorIndex) => {
            let currentTotalScore = 0;
            groups.forEach((groupKey) => {
              let currentGroupScore = 0;
              document
                .querySelectorAll(
                  `td[data-score][data-vendor-index="${vendorIndex}"]`
                )
                .forEach((cell) => {
                  const scoreKey = cell.dataset.score;
                  if (scoreKey.startsWith(groupKey)) {
                    const weight = getCellValue(
                      `td[data-weight="${scoreKey}"]`
                    );
                    const score = getCellValue(
                      `td[data-score="${scoreKey}"][data-vendor-index="${vendorIndex}"]`
                    );
                    currentGroupScore += (score * weight) / 10;
                  }
                });

              const groupScoreCell = document.querySelector(
                `td[data-score-group="${groupKey}"][data-vendor-index="${vendorIndex}"] .score`
              );
              if (groupScoreCell)
                groupScoreCell.innerText = currentGroupScore.toFixed(1);

              const groupWeight = getCellValue(
                `td[data-weight-group="${groupKey}"]`
              );
              groupScores[vendorIndex][groupKey] =
                groupWeight > 0 ? (currentGroupScore / groupWeight) * 10 : 0;

              currentTotalScore += currentGroupScore;
            });
            totalScores[vendorIndex] = currentTotalScore;
            const totalScoreCell = document.getElementById(
              `total-score-${vendorIndex}`
            );
            if (totalScoreCell)
              totalScoreCell.innerText = currentTotalScore.toFixed(1);
          });
          return { totalScores, groupScores, vendorNames: vendors };
        }

        function getTableData(tableId) {
          const table = document.getElementById(tableId);
          if (!table) return [];
          const data = [];
          const rows = table.querySelectorAll("tbody tr");
          rows.forEach((row) => {
            const rowData = [];
            row.querySelectorAll("td").forEach((cell) => {
              rowData.push(cell.innerText);
            });
            data.push(rowData);
          });
          return data;
        }

        function updateEvaluationBasis() {
          const basisMap = {
            A2: { tableId: "table-1", term: "Doanh thu", tab: 1 },
            A3: { tableId: "table-1-5", term: "Trình độ nhân sự", tab: 2 },
            B1: { tableId: "table-3", term: "Nền tảng Backend", tab: 4 },
            B2: { tableId: "table-3", term: "Framework sử dụng", tab: 4 },
            B3: { tableId: "table-3", term: "Core Web Vitals", tab: 4 },
            B4: { tableId: "table-3", term: "đánh giá bảo mật", tab: 4 },
            C1: { tableId: "table-4", term: "Quy trình thiết kế", tab: 5 },
            C2: { tableId: "table-4", term: "tính độc quyền", tab: 5 },
            C3: { tableId: "table-4", term: "Module Đặt phòng", tab: 5 },
            F1: { tableId: "table-1-5", term: "Mô hình triển khai", tab: 2 },
            F2: { tableId: "table-1-5", term: "quản lý thay đổi", tab: 2 },
            F3: { tableId: "table-1-5", term: "Nền tảng AI", tab: 2 },
            D1: { tableId: "table-5", term: "Chi phí Thiết kế", tab: 6 },
            D2: { tableId: "table-5", term: "Chi phí duy trì", tab: 6 },
            E1: { tableId: "table-6", term: "Thời gian bảo hành", tab: 7 },
            E2: { tableId: "table-6", term: "bàn giao", tab: 7 },
            E3: { tableId: "table-6", term: "Chính sách sao lưu", tab: 7 },
          };
          const vendors = Array.from(
            document.querySelectorAll("#table-2 thead th[contenteditable]")
          ).map((th) => th.innerText);
          Object.keys(basisMap).forEach((itemKey) => {
            const basisCell = document.querySelector(
              `[data-basis-for="${itemKey}"]`
            );
            if (basisCell) {
              const { tableId, term, tab } = basisMap[itemKey];
              const tableData = getTableData(tableId);
              const dataRow = tableData.find((r) =>
                r[0].toLowerCase().includes(term.toLowerCase())
              );
              let basisText = `<strong>Cơ sở (Tab ${tab}):</strong> ${term} | `;
              if (dataRow) {
                basisText += vendors
                  .map((v, i) => `${v}: ${dataRow[i + 1] || "N/A"}`)
                  .join("; ");
              } else {
                basisText += "Không tìm thấy dữ liệu.";
              }
              basisCell.innerHTML = basisText;
            }
          });
        }

        let charts = {};
        function updateDashboard() {
          const { totalScores, groupScores, vendorNames } = calculateScores();

          const costTableData = getTableData("table-5");
          const costDevRow = costTableData.find((r) =>
            r[0].includes("Thiết kế & Lập trình")
          );
          const costDev = costDevRow
            ? costDevRow
                .slice(1)
                .map((c) => parseInt(c.replace(/[^0-9.-]+/g, "")) || 0)
            : Array(vendorNames.length).fill(0);

          Object.values(charts).forEach((chart) => chart.destroy());

          const summaryTable = document.querySelector("#table-7-summary");
          if (summaryTable) {
            const vendorData = vendorNames
              .map((name, index) => ({
                name: name,
                score: totalScores[index],
                cost: costDev[index],
              }))
              .sort((a, b) => b.score - a.score);

            let summaryBodyHTML = "";
            vendorData.forEach((vendor, index) => {
              summaryBodyHTML += `<tr>
                            <td class="text-center font-bold">${index + 1}</td>
                            <td>${vendor.name}</td>
                            <td>${vendor.score.toFixed(1)}</td>
                            <td>${
                              vendor.cost > 0
                                ? parseInt(vendor.cost).toLocaleString(
                                    "vi-VN"
                                  ) + "đ"
                                : "N/A"
                            }</td>
                            <td contenteditable="true"></td>
                        </tr>`;
            });
            summaryTable.innerHTML = `<thead><tr><th>Xếp hạng</th><th>Nhà cung cấp</th><th>Tổng điểm</th><th>Chi phí triển khai</th><th>Ghi chú</th></tr></thead><tbody>${summaryBodyHTML}</tbody>`;
          }

          charts.valueChart = new Chart(
            document.getElementById("valueChart").getContext("2d"),
            {
              type: "bar",
              data: {
                labels: vendorNames,
                datasets: [
                  {
                    label: "Tổng điểm Năng lực (Thang 100)",
                    data: totalScores,
                    backgroundColor: "rgba(5, 150, 105, 0.7)",
                    yAxisID: "y-score",
                    order: 1,
                  },
                  {
                    label: "Chi phí triển khai (VND)",
                    data: costDev,
                    backgroundColor: "rgba(249, 115, 22, 0.7)",
                    yAxisID: "y-cost",
                    order: 2,
                  },
                ],
              },
              options: {
                responsive: true,
                plugins: { tooltip: { mode: "index", intersect: false } },
                scales: {
                  "y-score": {
                    type: "linear",
                    position: "left",
                    title: { display: true, text: "Điểm Năng lực" },
                    min: 0,
                    max: 100,
                  },
                  "y-cost": {
                    type: "linear",
                    position: "right",
                    title: { display: true, text: "Chi phí (VND)" },
                    grid: { drawOnChartArea: false },
                  },
                },
              },
            }
          );

          const createGroupChart = (canvasId, label, groupKey, colors) => {
            const chartCanvas = document.getElementById(canvasId);
            if (!chartCanvas) return;
            charts[canvasId] = new Chart(chartCanvas.getContext("2d"), {
              type: "bar",
              data: {
                labels: vendorNames,
                datasets: [
                  {
                    label: label,
                    data: vendorNames.map(
                      (v, i) => groupScores[i]?.[groupKey] ?? 0
                    ),
                    backgroundColor: colors,
                  },
                ],
              },
              options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true, max: 10 } },
              },
            });
          };

          const chartColors = ["#3b82f6", "#10b981", "#f97316", "#8b5cf6"];
          createGroupChart(
            "competencyChart",
            "Điểm Năng lực",
            "A",
            chartColors
          );
          createGroupChart("techChart", "Điểm Kỹ thuật", "B", chartColors);
          createGroupChart(
            "featureChart",
            "Điểm Thiết kế & Tính năng",
            "C",
            chartColors
          );
          createGroupChart(
            "processChart",
            "Điểm Quản lý Dự án",
            "F",
            chartColors
          );
          createGroupChart("supportChart", "Điểm Hậu mãi", "E", chartColors);
        }

        document
          .getElementById("update-charts-btn")
          .addEventListener("click", () => {
            calculateScores();
            updateEvaluationBasis();
            updateDashboard();
          });

        document
          .getElementById("export-btn")
          .addEventListener("click", function () {
            const wb = XLSX.utils.book_new();
            const sheetNames = [
              "1_ThongTinChung",
              "2_QuanLyDuAn",
              "3_ChamDiem",
              "4_CongNghe",
              "5_TinhNang",
              "6_ChiPhi",
              "7_HauMai",
              "8_Dashboard",
              "9_SWOT",
            ];
            const tableIds = [
              "table-1",
              "table-1-5",
              "table-2",
              "table-3",
              "table-4",
              "table-5",
              "table-6",
              "table-7-summary",
              "table-8-swot",
            ];

            tableIds.forEach((id, index) => {
              const table = document.getElementById(id);
              if (table) {
                const tableClone = table.cloneNode(true);
                if (id === "table-2") {
                  tableClone
                    .querySelectorAll('td[contenteditable="true"]')
                    .forEach((cell) => {
                      cell.removeAttribute("contenteditable");
                    });
                }
                const ws = XLSX.utils.table_to_sheet(tableClone, { raw: true });
                XLSX.utils.book_append_sheet(wb, ws, sheetNames[index]);
              }
            });
            const vendorName =
              document.querySelector("#table-1 th:nth-child(2)")?.innerText ||
              "SoSanh";
            XLSX.writeFile(
              wb,
              `So_Sanh_Nha_Cung_Cap_${vendorName.replace(/\s+/g, "_")}.xlsx`
            );
          });

        loadAllData();
        calculateScores();
        updateEvaluationBasis();
        document
          .getElementById("tab-container")
          .addEventListener("input", (e) => {
            if (
              e.target.matches(
                'td[contenteditable="true"], th[contenteditable="true"]'
              )
            ) {
              calculateScores();
              updateEvaluationBasis();
            }
          });
      });
    </script>
  </body>
</html>
